<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>View All Bookings</title>
    <!-- Link to custom CSS -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='admin_view_bookings.css') }}"
    />
  </head>
  <body>
    <div class="bookings-container">
      <!-- Flash Messages -->
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %} {% for category, message in messages %}
      <div class="flash-message alert-{{ category }}">
        <span class="message-text">{{ message }}</span>
        <span
          class="close-btn"
          onclick="this.parentElement.style.display='none';"
          >&times;</span
        >
      </div>
      {% endfor %} {% endif %} {% endwith %}

      <!-- Title -->
      <h1 class="title">All Bookings</h1>

      <!-- Bookings Table -->
      <div class="table-container">
        <table class="bookings-table">
          <thead>
            <tr>
              <th>Swimmer</th>
              <th>Session</th>
              <th>Date</th>
              <th>Time</th>
              <th>Payment Method</th>
              <th>Payment Status</th>
              <th>Session Status</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% if bookings %}
                {% for booking in bookings %}
                <tr>
                    <td>{{ booking.forename }} {{ booking.surname }}</td>
                    <td>{{ booking.description }}</td>
                    <td>{{ booking.date }}</td>
                    <td>{{ booking.start_time }} - {{ booking.end_time }}</td>
                    <td>{{ booking.paymentMethod }}</td>
                    <td>{{ 'Completed' if booking.isPaymentCompleted else 'Pending' }}</td>
                    <td>{{ 'Completed' if booking.isCompleted else 'Pending' }}</td>
                    <td>
                        {% if not booking.isPaymentCompleted and booking.paymentMethod == 'Cash' %}
                            <form action="{{ url_for('update_payment_status', swimmer_id=booking.swimmer_id, session_id=booking.session_id) }}" method="POST" style="display: inline;">
                                <button type="submit" class="btn-action">Mark Payment Completed</button>
                            </form>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="8">No bookings found</td>
                </tr>
            {% endif %}
          </tbody>
        </table>
      </div>

      <!-- Back Button -->
      <a href="{{ url_for('admin_homepage') }}" class="btn-back"
        >Back to Admin Dashboard</a
      >
    </div>
  </body>
</html>
